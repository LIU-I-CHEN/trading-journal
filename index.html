<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>交易筆記</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: #f4f4f4;
      margin: 0;
    }
    header {
      background: #111;
      color: white;
      text-align: center;
      padding: 1.2rem;
      font-size: 1.5rem;
      font-weight: 600;
    }
    .container {
      max-width: 860px;
      margin: 2rem auto;
      padding: 0 1rem;
    }
    form, .section, .textarea-section {
      background: white;
      padding: 1rem;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
      margin-bottom: 2rem;
    }
    form {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 1rem;
    }
    form input, form select, form button, textarea {
      padding: 0.5rem;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-family: 'Inter', sans-serif;
    }
    form button {
      grid-column: span 2;
      background: #111;
      color: white;
      cursor: pointer;
    }
    textarea {
      width: 100%;
      min-height: 120px;
      resize: vertical;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      border-radius: 8px;
      overflow: hidden;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }
    th, td {
      padding: 0.75rem;
      border-bottom: 1px solid #eee;
      text-align: center;
    }
    th {
      background: #fafafa;
      font-weight: 600;
    }
    .actions button {
      border: none;
      padding: 0.3rem 0.6rem;
      margin: 0 0.2rem;
      border-radius: 4px;
      cursor: pointer;
    }
    .edit { background: #ffc107; color: #fff; }
    .delete { background: #dc3545; color: #fff; }
  </style>
</head>
<body>
  <header>交易筆記</header>
  <div class="container">
    <form id="tradeForm">
      <input type="date" id="date" required />
      <input type="text" id="symbol" placeholder="交易品種" required />
      <select id="side">
        <option value="Long">多單</option>
        <option value="Short">空單</option>
      </select>
      <input type="number" id="entry" placeholder="進場價" step="0.01" required />
      <input type="number" id="exit" placeholder="出場價" step="0.01" required />
      <input type="number" id="quantity" placeholder="數量" step="0.01" required />
      <input type="text" id="notes" placeholder="備註" />
      <button type="submit">新增交易</button>
    </form>

    <div class="section">
      <table id="tradeTable">
        <thead>
          <tr>
            <th>日期</th><th>品種</th><th>方向</th><th>進場</th><th>出場</th><th>數量</th><th>盈虧</th><th>備註</th><th>操作</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>

    <div class="textarea-section">
      <h3>策略心得</h3>
      <textarea id="strategyNotes" placeholder="寫下你今天策略的優劣、感想..."></textarea>
    </div>

    <div class="textarea-section">
      <h3>交易回顧</h3>
      <textarea id="reviewNotes" placeholder="寫下今日整體表現、自我檢討與改進方向..."></textarea>
    </div>

  </div>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const form = document.getElementById('tradeForm');
  const tableBody = document.querySelector('#tradeTable tbody');
  const strategyNotes = document.getElementById('strategyNotes');
  const reviewNotes = document.getElementById('reviewNotes');

  let trades = JSON.parse(localStorage.getItem('trades') || '[]');
  let strategy = localStorage.getItem('strategyNotes') || '';
  let review = localStorage.getItem('reviewNotes') || '';
  strategyNotes.value = strategy;
  reviewNotes.value = review;

  function render() {
    tableBody.innerHTML = '';
    trades.forEach((t, i) => {
      const profit = ((t.side === 'Long' ? t.exit - t.entry : t.entry - t.exit) * t.quantity).toFixed(2);
      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${t.date}</td>
        <td>${t.symbol}</td>
        <td>${t.side}</td>
        <td>${t.entry}</td>
        <td>${t.exit}</td>
        <td>${t.quantity}</td>
        <td>${profit}</td>
        <td>${t.notes}</td>
        <td class="actions">
          <button class="edit" data-index="${i}">編輯</button>
          <button class="delete" data-index="${i}">刪除</button>
        </td>`;
      tableBody.appendChild(row);
    });
  }

  function save() {
    localStorage.setItem('trades', JSON.stringify(trades));
    localStorage.setItem('strategyNotes', strategyNotes.value);
    localStorage.setItem('reviewNotes', reviewNotes.value);
    render();
  }

  form.addEventListener('submit', e => {
    e.preventDefault();
    const newTrade = {
      date: form.date.value,
      symbol: form.symbol.value,
      side: form.side.value,
      entry: parseFloat(form.entry.value),
      exit: parseFloat(form.exit.value),
      quantity: parseFloat(form.quantity.value),
      notes: form.notes.value
    };
    trades.push(newTrade);
    save();
    form.reset();
  });

  tableBody.addEventListener('click', e => {
    if (e.target.classList.contains('delete')) {
      trades.splice(e.target.dataset.index, 1);
      save();
    } else if (e.target.classList.contains('edit')) {
      const idx = e.target.dataset.index;
      const t = trades[idx];
      form.date.value = t.date;
      form.symbol.value = t.symbol;
      form.side.value = t.side;
      form.entry.value = t.entry;
      form.exit.value = t.exit;
      form.quantity.value = t.quantity;
      form.notes.value = t.notes;
      trades.splice(idx, 1);
      save();
    }
  });

  strategyNotes.addEventListener('input', save);
  reviewNotes.addEventListener('input', save);

  render();
});
</script>
</body>
</html>
